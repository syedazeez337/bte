# BTE Test Scenario for xterm-specific extensions
# This tests xterm 256-color, true-color, and mouse tracking

name: xterm-extensions-test
description: Test xterm-specific extensions

# Note: This example demonstrates the BTE format.
# To test actual xterm extensions, use an xterm-compatible terminal test tool.
command: cat

steps:
  # Wait for xterm tester to be ready
  - action: wait_ticks
    ticks: 10

  # Simulate 256-color sequence (ESC ] 4 ; 256 ; ... ST)
  - action: send_keys
    keys: "\x1b]4;256;grey\x07"

  - action: wait_ticks
    ticks: 5

  # Simulate true-color sequence (ESC ] 10 ; ... ; ... ; ... ST)
  - action: send_keys
    keys: "\x1b]10;rgb:ff/00/00\x07"

  - action: wait_ticks
    ticks: 5

  # Simulate mouse tracking enable (ESC ? 1000 h)
  - action: send_keys
    keys: "\x1b[?1000h"

  - action: wait_ticks
    ticks: 5

  # Simulate window title set (ESC ] 0 ; ... ST)
  - action: send_keys
    keys: "\x1b]0;Test Window\x07"

  - action: wait_ticks
    ticks: 5

  # Verify output
  - action: assert_screen
    pattern: "\\x1b\\]"
    anywhere: true

  # Mouse tracking disable
  - action: send_keys
    keys: "\x1b[?1000l"

  - action: wait_ticks
    ticks: 5

  # Quit
  - action: send_keys
    keys: "q\n"

invariants:
  - type: cursor_bounds
    description: Cursor stays within screen bounds
  - type: viewport_valid
    description: Viewport dimensions are valid
